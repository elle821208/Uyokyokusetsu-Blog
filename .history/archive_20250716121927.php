<?php
/*
 * ファイル名: archive.php
 * 役割: 雑記ブログの記事を一覧表示するページのテンプレートファイル
 * 
 * このファイルは、以下のようなページを表示するのに使われます：
 * - カテゴリーのページ（例: /category/mindset/）
 * - 年月で記事をまとめたページ（例: /2025/07/）
 * - 雑記ブログの全体の一覧ページ（例: /blog/）
 *  下記の内容はそのままでコメントをさらに丁寧にしてぷらください。とくにif文について小学生にもわかるように教えてください。
 */

// サイトの一番上に表示する「共通のヘッダー部分」を読み込みます（header.phpの内容）
get_header();
?>

<!-- サイトのメインの部分を囲むブロック -->
<div id="content">
  <!-- 記事一覧が入るメインエリア -->
  <div id="main">

    <!-- このページのタイトル（見出し）を表示 -->
    <h1>
      <?php
      // ▼ ここからは「どんなページを見ているか」によって、タイトルの文字を変える処理です。

      /*
       * ▼「もし今見ているページがカテゴリーのページだったら」
       * たとえば「mindset」というカテゴリーページにアクセスしたときに使われます。
       * 「is_category()」は「今のページがカテゴリーかどうか」を調べてくれる関数です。
       */
      if (is_category()) {
        // カテゴリーの名前を表示します（例：mindset）
        single_cat_title();

        // その後ろに「雑記ブログ投稿一覧」と文字を追加して表示
        echo ' 雑記ブログ投稿一覧';


      /*
       * ▼「もしURLに 'year'（年）と 'monthnum'（月）がついていたら」
       * 例: /2025/07 というURLのページを見ているとき
       * → 「2025年7月の雑記ブログ投稿一覧」と表示されます
       */
      } elseif (get_query_var('year') && get_query_var('monthnum')) {

        // get_query_var()：URLから「年」や「月」の数字を取り出す関数
        $year  = get_query_var('year');     // 年（例：2025）
        $month = get_query_var('monthnum'); // 月（例：07）

        // 年と月を日本語でつなげて表示（例：2025年7月 の雑記ブログ投稿一覧）
        echo esc_html($year) . '年' . esc_html($month) . '月 の雑記ブログ投稿一覧';


      /*
       * ▼上のどちらでもなければ（つまりカテゴリーでも年月でもない場合）
       * 通常の雑記ブログの全体一覧（/blogなど）として「最新の雑記ブログ投稿一覧」と表示
       */
      } else {
        echo '最新の雑記ブログ投稿一覧';
      }
      ?>
    </h1>

    <?php
    /*
     * ▼ここからは「記事があるかどうか」を調べて、記事を一覧で表示する部分です。
     *
     * have_posts() は「記事がまだあるかな？」という関数
     * true（本当）なら while 文でくり返し記事を1件ずつ表示します。
     */
    if (have_posts()):

      // ▼記事があるあいだ、1つずつ取り出して表示するループ
      while (have_posts()): the_post();
    ?>
      <!-- ▼1つの投稿の情報を表示するブロック -->
      <div class="title">
        <!-- 投稿のタイトルをクリックできるようにリンクつきで表示 -->
        <a href="<?php the_permalink(); ?>"><?php the_title(); ?></a><br>

        <!-- 投稿が公開された日付を表示 -->
        <small>投稿日: <?php the_time('Y年n月j日'); ?></small><br>

        <!-- 投稿がどのカテゴリに属しているかを表示 -->
        <small>カテゴリ: <?php the_category(', '); ?></small>
      </div>

    <?php
      // while のくり返しが終わる（記事を全部表示し終わったら終了）
      endwhile;

    // ▼もし記事が1件もなかったら、下のメッセージを表示
    else:
    ?>
      <p>この記事カテゴリにはまだ投稿がありません。</p>
    <?php endif; ?>
  </div>

  <!-- サイドバーを読み込む（sidebar.php の内容がここに表示されます） -->
  <?php get_sidebar(); ?>
</div>

<!-- サイトの一番下（footer.php）の内容を読み込みます -->
<?php get_footer(); ?>
