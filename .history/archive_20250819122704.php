<?php
/*
 * ファイル名: archive.php
 * 役割: 雑記ブログの記事を一覧表示するページ
 * 
 * このファイルは、下のような「記事のまとめページ」を表示するときに自動で使われます：
 * - カテゴリーページ（例: /category/mindset/）
 * - 年や月ごとのページ（例: /2025/07/）
 * - 雑記ブログの全体一覧ページ（例: /blog/）
 *
 * ▼ポイント
 * WordPressは「どの種類のページを見ているか」によって、
 * 自動でこのテンプレートを使ってページを作ってくれます。
 */
 
// サイトの上の部分（メニューやロゴなど）を読み込む
get_header();
?>

<!-- サイトのメイン部分を包む箱 -->
<div id="content">
  <!-- 記事一覧を表示するメインエリア -->
  <div id="main">

    <!-- ページのタイトル（見出し） -->
    <h1>
      <?php
      /*
       * ▼ここでは「見ているページの種類」によって
       * 見出しの文字を変えています。
       *
       * if 文 = 「もし ○○ だったら △△ する」というルール
       * プログラムの「分かれ道」みたいなものです。
       */

      // もし「カテゴリーページ」だったら（例: /category/mindset/）
      if (is_category()) {
        // そのカテゴリの名前を表示（例：mindset）
        single_cat_title();

        // 後ろに「雑記ブログ投稿一覧」と文字を追加
        echo ' 雑記ブログ投稿一覧';

      // もし「年」と「月」が指定されたページだったら（例: /2025/07/）
      } elseif (get_query_var('year') && get_query_var('monthnum')) {
        // URLから「年」と「月」を取り出す
        $year  = get_query_var('year');     // 例：2025
        $month = get_query_var('monthnum'); // 例：07

        // 「2025年7月 の雑記ブログ投稿一覧」と表示
        echo esc_html($year) . '年' . esc_html($month) . '月 の雑記ブログ投稿一覧';

      // 上のどちらでもなければ（つまり普通の雑記ブログ一覧ページなら）
      } else {
        // 「最新の雑記ブログ投稿一覧」と表示
        echo '最新の雑記ブログ投稿一覧';
      }
      ?>
    </h1>

    <?php
    /*
     * ▼ここからは「記事を実際に表示する部分」です。
     *
     * have_posts() = 「まだ記事が残ってる？」をチェックする関数
     * もし記事があれば true（はい）、なければ false（いいえ）を返します。
     *
     * if (have_posts()) { ... } else { ... }
     * → もし記事があれば一覧を出す、なければ「記事はありません」と表示する
     */
    if (have_posts()):

      // 記事があるあいだ、1つずつ取り出して表示するループ
      while (have_posts()): the_post();
    ?>
      <!-- ▼1つの記事の情報を表示するブロック -->
      <div class="title">
        <!-- 記事のタイトルをリンク付きで表示 -->
        <a href="<?php the_permalink(); ?>"><?php the_title(); ?></a><br>

        <!-- 記事が公開された日付 -->
        <small>投稿日: <?php the_time('Y年n月j日'); ?></small><br>

        <!-- 記事が属しているカテゴリ -->
        <small>カテゴリ: <?php the_category(', '); ?></small>
      </div>

    <?php
      // 記事を全部表示し終わったら終了
      endwhile;

    // もし記事が1つもなかったら
    else:
    ?>
      <p>この記事カテゴリにはまだ投稿がありません。</p>
    <?php endif; ?>
  </div>

  <!-- サイドバーを読み込む（sidebar.phpの内容がここに表示されます） -->
  <?php get_sidebar(); ?>
</div>

<!-- サイトの一番下（footer.phpの内容）を読み込む -->
<?php get_footer(); ?>
